<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯›æ‰˜é‚¦æ˜Ÿéš›ç™»è‰¦é ç´„ âœˆï¸</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="stars"></div>
    <div class="twinkling"></div>
    <div class="clouds"></div> <div class="container">
        <h1>æ¯› æ‰˜ é‚¦ æ˜Ÿ éš› ç™» è‰¦ é  ç´„ è¡¨ ğŸš€</h1>
        <p class="slogan">
            æ­¡è¿ç™»è‰¦ï¼è«‹å”åŠ©æˆ‘å€‘å®Œæˆæ‚¨çš„æ˜Ÿéš›æ—…ç¨‹ç”³è«‹ï¼Œ<br>
            è®“æ¯›æ‰˜é‚¦çš„ä½¿è€…èƒ½ç‚ºæ‚¨çš„æ¯›å­©æº–å‚™æœ€å®Œç¾çš„æ˜Ÿçƒå‡æœŸ ğŸŒŸ
        </p>

        <form id="appointmentForm" action="#" method="POST" class="star-form">
            <h2>ğŸš€ ä¸€ã€ç™»è‰¦ä»»å‹™é¸æ“‡</h2>
            <div class="form-group checkbox-group">
                <label><input type="checkbox" name="missionType" value="ç‹—ç‹—å®‰è¦ªä»»å‹™"> ç‹—ç‹—å®‰è¦ªä»»å‹™ï¼ˆçŸ­æœŸç™»è‰¦ï¼‰</label>
                <label><input type="checkbox" name="missionType" value="ç‹—ç‹—æ—…é¤¨ä»»å‹™"> ç‹—ç‹—æ—…é¤¨ä»»å‹™ï¼ˆæ˜Ÿéš›ä½å®¿ï¼‰</label>
            </div>

            <div class="form-group">
                <label for="startDate">ğŸ“… ç™»è‰¦æ—¥æœŸï¼š</label>
                <input type="datetime-local" id="startDate" name="startDate" required>
            </div>
            
            <div class="form-group">
                <label for="endDate">ğŸª è¿”å›æ—¥æœŸï¼š</label>
                <input type="datetime-local" id="endDate" name="endDate" required>
            </div>

            <h2>ğŸ¾ äºŒã€æ—…å®¢è³‡æ–™ï¼ˆæ¯›å­©è³‡è¨Šï¼‰</h2>
            <div class="form-group">
                <label for="petName">ğŸ‘©â€ğŸš€ æ¯›å­©å§“åï¼š</label>
                <input type="text" id="petName" name="petName" required>
            </div>

            <div class="form-group radio-group">
                <label>âš§ æ€§åˆ¥ï¼š</label>
                <label><input type="radio" name="gender" value="ç”·å­©" required> ç”·å­©</label>
                <label><input type="radio" name="gender" value="å¥³å­©"> å¥³å­©</label>
            </div>

            <div class="form-group radio-group">
                <label>æ˜¯å¦çµ•è‚²ï¼š</label>
                <label><input type="radio" name="neutered" value="å·²çµ•è‚²" required> å·²çµ•è‚²</label>
                <label><input type="radio" name="neutered" value="æœªçµ•è‚²"> æœªçµ•è‚²</label>
            </div>

            <div class="form-group">
                <label for="breed">ğŸ• å“ç¨®ï¼š</label>
                <input type="text" id="breed" name="breed" required>
            </div>
            
            <div class="form-group">
                <label for="weight">âš–ï¸ é«”é‡ (kg)ï¼š</label>
                <input type="number" step="0.1" id="weight" name="weight" required>
            </div>
            
            <div class="form-group">
                <label for="age">ğŸ‚ å¹´é½¡ (æ­²)ï¼š</label>
                <input type="number" id="age" name="age" required>
            </div>

            <div class="form-group radio-group">
                <label>ğŸŒˆ è¿‘æœŸå¥åº·ç‹€æ³ï¼š</label><br>
                <label><input type="radio" name="health" value="å¥åº·è‰¯å¥½" required> å¥åº·è‰¯å¥½</label>
                <label><input type="radio" name="health" value="æœ‰ç‹€æ³"> æœ‰ç‹€æ³ (è«‹èªªæ˜ï¼š<input type="text" name="healthDetail" class="inline-input">)</label>
            </div>

            <div class="form-group checkbox-group">
                <label>ğŸ’« å€‹æ€§æª”æ¡ˆ (å¯è¤‡é¸)ï¼š</label><br>
                <label><input type="checkbox" name="personality" value="æ´»æ½‘å¤–å‘"> æ´»æ½‘å¤–å‘</label>
                <label><input type="checkbox" name="personality" value="å®‰éœæ–‡éœ"> å®‰éœæ–‡éœ</label>
                <label><input type="checkbox" name="personality" value="æ„›åƒå°é¥é¬¼"> æ„›åƒå°é¥é¬¼</label><br>
                <label><input type="checkbox" name="personality" value="è†½å°å…§å‘"> è†½å°å…§å‘</label>
                <label><input type="checkbox" name="personality" value="è­¦æˆ’æ•éŠ³"> è­¦æˆ’æ•éŠ³</label>
                <label><input type="checkbox" name="personality" value="éœ€è¦æ…¢ç†±é™ªä¼´"> éœ€è¦æ…¢ç†±é™ªä¼´</label><br>
                <label for="otherPersonality">å…¶ä»–ç‰¹è³ªï¼š</label>
                <input type="text" id="otherPersonality" name="otherPersonality" class="inline-input">
            </div>

            <div class="form-group">
                <label>âš ï¸ æ˜¯å¦æœ‰ç‰¹æ®Šè¡Œç‚ºï¼Ÿ</label><br>
                <label><input type="checkbox" name="specialBehavior" value="è­·é£Ÿï¼è­·ç©å…·"> è­·é£Ÿï¼è­·ç©å…·</label><br>
                <label><input type="checkbox" name="specialBehavior" value="åˆ†é›¢ç„¦æ…®ï¼å å«å•é¡Œ"> åˆ†é›¢ç„¦æ…®ï¼å å«å•é¡Œ</label><br>
                <label>å…¶ä»–ï¼š<input type="text" name="otherBehavior" class="inline-input"></label>
            </div>


            <h2>ğŸ‘¨â€ğŸš€ ä¸‰ã€åœ°çƒé£¼ä¸»è³‡æ–™</h2>
            <div class="form-group">
                <label for="ownerName">é£¼ä¸»å§“åï¼š</label>
                <input type="text" id="ownerName" name="ownerName" required>
            </div>
            <div class="form-group">
                <label for="phone">è¯çµ¡é›»è©±ï¼š</label>
                <input type="tel" id="phone" name="phone" required>
            </div>
            <div class="form-group">
                <label for="address">è¯çµ¡åœ°å€ï¼š</label>
                <input type="text" id="address" name="address" required>
            </div>

            <div class="form-group radio-group">
                <label>æ˜¯å¦æ›¾æ­ä¹˜æ¯›æ‰˜é‚¦æˆ–å…¶ä»–æ˜Ÿçƒæ—…å®¿ï¼š</label><br>
                <label><input type="radio" name="experience" value="åˆæ¬¡ç™»è‰¦ï¼è«‹å¤šç…§é¡§ ğŸ¥¹" required> åˆæ¬¡ç™»è‰¦ï¼è«‹å¤šç…§é¡§ ğŸ¥¹</label><br>
                <label><input type="radio" name="experience" value="æœ‰ç¶“é©—çš„å¤ªç©ºæ—…å®¢ ğŸ›¸"> æœ‰ç¶“é©—çš„å¤ªç©ºæ—…å®¢ ğŸ›¸</label>
            </div>
            
            <h2>ğŸ§³ å››ã€æ—…ç¨‹å‚™è¨»èˆ‡æº–å‚™</h2>
            <div class="form-group radio-group">
                <label>æ˜¯å¦å·²é–±è®€ã€Šæ¯›æ‰˜é‚¦ä½å®¿é ˆçŸ¥ã€‹ï¼š</label><br>
                <label><input type="radio" name="agreement" value="å·²é–±è®€ä¸¦åŒæ„" required> æ˜¯ï¼Œæˆ‘å·²äº†è§£ä¸¦åŒæ„æ˜Ÿéš›æ¢æ¬¾ ğŸ’«</label><br>
                <label><input type="radio" name="agreement" value="å°šæœªé–±è®€ï¼Œè«‹å‚³çµ¦æˆ‘ ğŸª"> å°šæœªé–±è®€ï¼Œè«‹å‚³çµ¦æˆ‘ ğŸª</label>
            </div>

            <div class="form-group">
                <label for="notes">å…¶ä»–å‚™è¨»äº‹é …ï¼š</label><br>
                <textarea id="notes" name="notes"></textarea>
            </div>

            <div class="reminders">
                <h3>ğŸ’ ç™»è‰¦å‰æé†’</h3>
                <p>âœ¨ æ”¯ä»˜å®šé‡‘å¾Œï¼Œæ‚¨çš„ç™»è‰¦å¸­æ¬¡å³å®Œæˆé ç´„ã€‚</p>
                <p>âœ¨ æ—…ç¨‹å‰ï¼Œè«‹æº–å‚™æ¯›å­©å¹³å¸¸åƒçš„é£¼æ–™ã€é»å¿ƒã€ç©å…·æˆ–è¢«è¢«ï¼Œ<br>ã€€è®“ç‰ åœ¨ç•°æ˜Ÿä¹Ÿèƒ½å®‰å¿ƒå…¥çœ ã€‚</p>
            </div>

            <div class="footer-info">
                <p>æ¯›æ‰˜é‚¦Â·å°å¯“æ‰€ Maotopia Nook</p>
                <p>ã€Œæ¯ä¸€æ¬¡ç™»è‰¦ï¼Œéƒ½æ˜¯æ¯›å­©å¥”å‘å¹¸ç¦çš„æ—…ç¨‹ã€‚ã€</p>
                <p>ğŸ“ ç«¹åŒ—æ˜Ÿå€ï½œå¤©æ¯æ˜Ÿå€å³å°‡å•Ÿèˆª</p>
                <p>â˜ï¸ è¯çµ¡ä½¿è€…ï¼š[æ‚¨çš„è¯çµ¡é›»è©±]</p>
            </div>

            <button type="submit" class="submit-btn">å®Œæˆç™»è‰¦é ç´„</button>
        </form>
    </div>

    <script>
        document.getElementById('appointmentForm').addEventListener('submit', function(e) {
            e.preventDefault(); // é˜»æ­¢è¡¨å–®å‚³çµ±æäº¤

            const form = e.target;
            // ç”±æ–¼æœ‰äº›æ¬„ä½æ˜¯å¤šé¸ï¼Œä½¿ç”¨ FormData å¯èƒ½æ›´æ–¹ä¾¿è™•ç†
            const formData = new FormData(form);
            const params = new URLSearchParams();
            for (const pair of formData.entries()) {
                // ç‰¹åˆ¥è™•ç†å¤šé¸æ¡†ï¼Œå°‡å€¼åˆä½µ
                if (pair[0] === 'missionType' || pair[0] === 'personality' || pair[0] === 'specialBehavior') {
                    // å¦‚æœæ˜¯ç¬¬ä¸€å€‹å€¼ï¼Œç›´æ¥è¨­å®šï¼›å¦å‰‡ï¼Œè¿½åŠ 
                    if (params.has(pair[0])) {
                        params.set(pair[0], params.get(pair[0]) + 'ã€' + pair[1]);
                    } else {
                        params.set(pair[0], pair[1]);
                    }
                } else {
                    params.set(pair[0], pair[1]);
                }
            }
            
            // !!! æ›¿æ›æˆæ‚¨åœ¨ Google Apps Script éƒ¨ç½²å¾Œçš„ Web App URL !!!
            const WEB_APP_URL = 'æ‚¨çš„ Google Apps Script éƒ¨ç½² URL'; 

            fetch(WEB_APP_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: params.toString()
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    alert('ç™»è‰¦é ç´„æˆåŠŸï¼é€šçŸ¥å·²ç™¼é€çµ¦æ¯›æ‰˜é‚¦ä½¿è€…ã€‚');
                    form.reset(); // æ¸…ç©ºè¡¨å–®
                } else {
                    alert('é ç´„å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–ç›´æ¥è¯ç¹«ä½¿è€…ã€‚\néŒ¯èª¤è¨Šæ¯: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                alert('é€£ç·šéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ–ç›´æ¥è¯ç¹«ä½¿è€…ã€‚');
            });
        });
document.getElementById('appointmentForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const form = e.target;
    function getCheckboxValues(name) {
        return Array.from(form.querySelectorAll(`input[name="${name}"]:checked`))
                    .map(input => input.value).join(', ');
    }
    function getRadioValue(name) {
        const checked = form.querySelector(`input[name="${name}"]:checked`);
        return checked ? checked.value : '';
    }

    const data = {
        missionType: getCheckboxValues('missionType'),
        startDate: form.startDate.value,
        endDate: form.endDate.value,
        petName: form.petName.value,
        gender: getRadioValue('gender'),
        neutered: getRadioValue('neutered'),
        breed: form.breed.value,
        weight: form.weight.value,
        age: form.age.value,
        health: getRadioValue('health'),
        healthDetail: form.healthDetail.value || '',
        personality: getCheckboxValues('personality'),
        otherPersonality: form.otherPersonality.value || '',
        specialBehavior: getCheckboxValues('specialBehavior'),
        otherBehavior: form.otherBehavior.value || '',
        ownerName: form.ownerName.value,
        phone: form.phone.value,
        address: form.address.value,
        experience: getRadioValue('experience'),
        agreement: getRadioValue('agreement'),
        notes: form.notes.value || ''
    };

    try {
        const response = await fetch('/send-line', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        if(response.ok){
            alert('é ç´„è³‡æ–™å·²é€å‡ºï¼æ¯›æ‰˜é‚¦ä½¿è€…å°‡æ”¶åˆ° LINE è¨Šæ¯ âœ¨');
            form.reset();
        } else {
            alert('é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
        }
    } catch (err) {
        console.error(err);
        alert('é€å‡ºç™¼ç”ŸéŒ¯èª¤ï¼');
    }
});
</script>

</body>
</html>
