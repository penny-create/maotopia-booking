<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>毛托邦星際登艦預約</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="stars"></div>
    <div class="twinkling"></div>
    <div class="clouds"></div> <div class="container">
        <h1>毛 托 邦 星 際 登 艦 預 約 表 🚀</h1>
        <p class="slogan">
            歡迎登艦！請協助我們完成您的星際旅程申請，<br>
            讓毛托邦的使者能為您的毛孩準備最完美的星球假期 🌟
        </p>

        <form id="appointmentForm" action="#" method="POST" class="star-form">
            <h2>🚀 一、登艦任務選擇</h2>
            <div class="form-group checkbox-group">
                <label><input type="checkbox" name="missionType" value="狗狗安親任務"> 狗狗安親任務（短期登艦）</label>
                <label><input type="checkbox" name="missionType" value="狗狗旅館任務"> 狗狗旅館任務（星際住宿）</label>
            </div>

           

            <div class="footer-info">
                <p>毛托邦·小寓所 Maotopia Nook</p>
                <p>「每一次登艦，都是毛孩奔向幸福的旅程。」</p>
                <p>📍 竹北星區｜天母星區即將啟航</p>
                <p>☎️ 聯絡使者：[您的聯絡電話]</p>
            </div>

            <button type="button" id="testbutton" class="submit-btn">完成登艦預約</button>
        </form>
    </div>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
  let userId = '';
  const LINE_TOKEN = "MCDA7LNbI0SvMGoX6CKeBveY2A3qqIY0WRE3ggWqlqRFxxqnyFo+B6pPN9Jjky5gNWKwdzyohI0Lfru1orWI5dbrL4hxrSW7nfuns5cyazCEqWnXPJFYNuavhr5wMRMgxpI9HkYBJpiL+gQHgeR1QAdB04t89/1O/w1cDnyilFU=";
  document.addEventListener('DOMContentLoaded', async () => {
    try {
      await liff.init({ liffId: '2008333754-ODxKZRr9' });
      console.log('✅ LIFF 初始化成功');

      if (!liff.isLoggedIn()) {
        liff.login();
        return;
      }

      const profile = await liff.getProfile();
      userId = profile.userId; // ← 傳給後端
      console.log('使用者 ID:', userId);
      document.querySelector('input[name="ownerName"]').value = profile.displayName;
    } catch (err) {
      console.error('❌ LIFF 初始化失敗:', err);
    }
  });

document.getElementById("testbutton").addEventListener("click", function () {
  console.log("按鈕被點擊了！");
  const form = document.getElementById("appointmentForm");
  
  // 取得表單資料
  const formData = new FormData(form);
  const data = Object.fromEntries(formData.entries());
  
  // 處理多選 missionType
  data.missionType = Array.from(form.querySelectorAll('input[name="missionType"]:checked'))
                          .map(el => el.value);
  
  // 加上使用者 ID
  data.userId = userId;

  // 發送 JSON 給後端
  fetch("https://maotopia-api.onrender.com/line", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(result => {
    console.log("伺服器回應：", result);
    alert(result.message);
  })
  .catch(err => {
    console.error("發生錯誤：", err);
    alert("發生錯誤，請稍後再試！");
  });
});
  </script>
</body>
</html>















